<%- include('../partials/header.ejs') %>
<div class="card new-order-card">
  <h2 class="form-title">ğŸ›’ Your Cart</h2>

  <% if (bookCart && bookCart.length > 0) { %>
    <form action="/orders" method="POST" class="form-vertical">
      <% bookCart.forEach((book, index) => { %>
        <div class="cart-item">
          <input type="hidden" name="cart[]" value="<%= book.id %>" />

          <p><strong>ISBN:</strong> <%= book.isbn || 'N/A' %></p>
          <p><strong>Title:</strong> <%= book.title %></p>
          <p><strong>Unit Price:</strong> $<%= book.unitPrice %></p>
          <div class="form-group">
            <label for="qty-<%= index %>">Quantity:</label>
            <input 
              type="number" 
              id="qty-<%= index %>" 
              name="qty[<%= book.id %>]"
              value="<%= book.qty %>" 
              min="1" 
              max="1" 
              required
            />
          </div>
          <a href="/orders/deleteFromCart/<%= book.id %>" class="btn btn-danger btn-sm mt-1">Remove</a>
          <hr/>
        </div>
      <% }) %>

      <p class="cart-total"><strong>Total: $<%= bookCart.reduce((sum, item) => sum + item.unitPrice * item.qty, 0) %></strong></p>

      <div class="form-group">
        <label for="deliveryAddress">Delivery Address:</label>
        <input type="text" name="deliveryAddress" id="deliveryAddress" required />
      </div>

      <button type="submit" class="btn btn-success mt-1">ğŸ“¦ Place Order</button>
    </form>
    <form action="/orders/clearCart" method="POST" class="mt-2">
      <button type="submit" class="btn btn-danger">ğŸ—‘ï¸ Clear Cart</button>
    </form>
  <% } else { %>
    <p>Your cart is empty.</p>
  <% } %>
</div>
<%- include('../partials/footer.ejs') %>
